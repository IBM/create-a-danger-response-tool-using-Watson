'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);var _classnames=require('classnames');var _classnames2=_interopRequireDefault(_classnames);var _reactDropzone=require('react-dropzone');var _reactDropzone2=_interopRequireDefault(_reactDropzone);var _Icon=require('../Icon');var _Colors=require('../Colors');var _Colors2=_interopRequireDefault(_Colors);var _ArrowBox=require('../ArrowBox');var _ArrowBox2=_interopRequireDefault(_ArrowBox);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Tile=require('./Tile');var InputImageUrl=require('./Url');var ImagePicker=function(_React$Component){_inherits(ImagePicker,_React$Component);function ImagePicker(props){_classCallCheck(this,ImagePicker);var _this=_possibleConstructorReturn(this,(ImagePicker.__proto__||Object.getPrototypeOf(ImagePicker)).call(this,props));_this.componentDidMount=function(){document.addEventListener('dragover',_this.onDragOver,false);document.addEventListener('dragleave',_this.onDragLeave,false);};_this.componentWillUnmount=function(){document.removeEventListener('dragover',_this.onDragOver);document.removeEventListener('dragover',_this.onDragLeave);};_this.onDragOver=function(){_this.setState({isDragging:true});};_this.onDragLeave=function(){_this.setState({isDragging:false});};_this.onUrlSubmit=function(event,url){_this.setState({previewImage:{url:url,alt:'User supplied url'},selectedTile:-1});if(_this.props.onUrlSubmit){_this.props.onUrlSubmit.call(_this,{url:url});}};_this.onDrop=function(files){var image=files[0];if(_this.props.onDrop){_this.props.onDrop.call(_this,image);}};_this.onDropAccepted=function(files){var image=files[0];_this.setState({previewImage:{url:image.preview,alt:'preview image'},selectedTile:-1,isDragging:false});if(_this.props.onDropAccepted){_this.props.onDropAccepted.call(_this,image);}};_this.onDropRejected=function(files){var image=files[0];_this.setState({previewImage:null,selectedTile:-1,isDragging:false});if(_this.props.onDropRejected){_this.props.onDropRejected.call(_this,image);}};_this.onClickTile=function(index){_this.setState({selectedTile:index,previewImage:null});if(_this.props.onClickTile){_this.props.onClickTile.call(_this,_this.props.images[index],index);}};_this.onClosePreview=function(){_this.setState({previewImage:null});if(_this.props.onClosePreview){_this.props.onClosePreview.call(_this);}};_this.showPreview=function(){return!_this.props.disablePreviewImage&&_this.state.previewImage&&!(_this.props.fileError||_this.props.urlError||_this.props.error);};_this.showUrlInput=function(){return(// if there is no previewImage, or the previewImage is disabled,
// and urlInput is not disabled, and there are any error messages,
// then show the url input
(!_this.state.previewImage||_this.state.previewImage&&_this.disablePreviewImage)&&!_this.props.disableUrlInput||_this.props.fileError||_this.props.urlError||_this.props.error);};_this.state={previewImage:null,// { url: string, alt: string }
selectedTile:-1,isDragging:false};// image tile is already selected
if(_this.props.initialPreviewImage&&_this.props.initialPreviewImage!==null){var index=_this.props.images.map(function(e){return e.url;}).indexOf(_this.props.initialPreviewImage.url);if(index!==-1){_this.state.selectedTile=index;}// url image selected
if(_this.props.initialPreviewImage.url){_this.state.previewImage={url:_this.props.initialPreviewImage.url,alt:_this.props.initialPreviewImage.alt||'User supplied url'};}}return _this;}// boolean logic for showing preview image or not
// boolean logic for showing url input or not
_createClass(ImagePicker,[{key:'render',value:function render(){var _this2=this;return _react2.default.createElement('div',{className:'image-picker--section'},_react2.default.createElement('div',null,this.props.images.map(function(image,index){return _react2.default.createElement(Tile,{grayout:_this2.state.previewImage!=null||_this2.state.selectedTile>-1&&index!==_this2.state.selectedTile,image:image.url,alt:image.alt,key:index// eslint-disable-next-line
,onClick:_this2.onClickTile.bind(null,index),dataId:index});}),!this.props.disableFileInput?_react2.default.createElement('div',{className:'image-picker--tile'},_react2.default.createElement(_ArrowBox2.default,{className:'image-picker--arrow-box',direction:'top',icon:'error',color:_Colors2.default.red_50,width:'100%',show:Boolean(this.props.fileError)},_react2.default.createElement('p',{className:'base--p image-picker--error-message'},this.props.fileError)),this.showPreview()?_react2.default.createElement(_Icon.Icon,{className:'image-picker--preview-x',type:'close',size:'small',onClick:this.onClosePreview}):null,_react2.default.createElement('label',{className:(0,_classnames2.default)('image-picker--tile-input-container',{'image-picker--tile-input-container_error':this.props.fileError}),htmlFor:'image-picker--file-input'},this.showPreview()?_react2.default.createElement('div',{className:'image-picker--preview-image-container'},_react2.default.createElement('img',{className:'image-picker--preview-image',src:this.state.previewImage.url,alt:this.state.previewImage.alt})):null,_react2.default.createElement(_reactDropzone2.default,{accept:this.props.accept,className:(0,_classnames2.default)('content','dropzone',{'dropzone_on-drag':this.state.isDragging}),disableClick:this.props.disableClick,inputProps:this.props.inputProps,maxSize:this.props.maxSize,minSize:this.props.minSize,multiple:this.props.multiple,name:this.props.name,onDrop:this.onDrop,onDropAccepted:this.onDropAccepted,onDropRejected:this.onDropRejected},_react2.default.createElement('div',{className:'image-picker--tile-input-description'},'Select or drag an image'),_react2.default.createElement('div',{className:'image-picker--tile-input-icon'},_react2.default.createElement(_Icon.Icon,{type:'plus',size:'regular'})))),this.showUrlInput()?_react2.default.createElement(InputImageUrl,{onInputChange:this.props.onUrlInputChange,onSubmit:this.onUrlSubmit,placeholder:this.props.urlPlaceholder,error:this.props.urlError}):null):null),this.props.error?_react2.default.createElement(_ArrowBox2.default,{className:'image-picker--arrow-box',direction:'none',icon:'error',color:_Colors2.default.red_50,style:{display:'block',position:'relative',visibility:'visible',opacity:'1',margin:'auto'}},_react2.default.createElement('p',{className:'base--p image-picker--error-message'},this.props.error)):null);}}]);return ImagePicker;}(_react2.default.Component);exports.default=ImagePicker;ImagePicker.propTypes={error:_propTypes2.default.string,// Event Handlers
onClickTile:_propTypes2.default.func,// args: image obj this.props.images, index; when file is clicked
onDrop:_propTypes2.default.func,// args: File image; when file is chosen or dragged and dropped
onDropAccepted:_propTypes2.default.func,// args: File image; when file is chosen successfully
onDropRejected:_propTypes2.default.func,// args: File image; when file is chosen unsuccessfully
onUrlSubmit:_propTypes2.default.func,// when hitting enter as url input is focused
onUrlInputChange:_propTypes2.default.func,// event when url input changes
onClosePreview:_propTypes2.default.func,// event when preview image is closing
// tile props
images:_propTypes2.default.arrayOf(_propTypes2.default.shape({url:_propTypes2.default.string,alt:_propTypes2.default.string})).isRequired,// preview tile props
disablePreviewImage:_propTypes2.default.bool,initialPreviewImage:_propTypes2.default.shape({url:_propTypes2.default.string.isRequired,alt:_propTypes2.default.string}),// have component display a preview image by default
// file input props
// detailed documentation on dropzone properties can be found at
// https://github.com/okonet/react-dropzone
disableFileInput:_propTypes2.default.bool,// option to remove File Input / Dropzone component
accept:_propTypes2.default.string,// accepted filetypes
disableClick:_propTypes2.default.bool,// option to make dropzone clickable or not
// file chooser input properties
inputProps:_propTypes2.default.object,// eslint-disable-line
maxSize:_propTypes2.default.number,// max file size
minSize:_propTypes2.default.number,// min file size
multiple:_propTypes2.default.bool,// option for multiple files
name:_propTypes2.default.string,fileError:_propTypes2.default.string,// error message on file input
// url input props
disableUrlInput:_propTypes2.default.bool,// option to remove url input component
urlPlaceholder:_propTypes2.default.string,// placeholder text for url input
urlError:_propTypes2.default.string// error message on url input
};ImagePicker.defaultProps={images:[0,1,2,3].map(function(_,i){return{url:'https://placeholdit.imgix.net/~text?txtsize=33&txt=200%C3%97150&w=200&h=150',alt:'Sample '+i};}),disablePreviewImage:false,initialPreviewImage:null,disableFileInput:false,accept:'image/*',disableClick:false,inputProps:{},maxSize:Infinity,minSize:0,multiple:false,name:'file-chooser',disableUrlInput:false,urlPlaceholder:'Paste an image URL',error:null,fileError:null,urlError:null,onClickTile:function onClickTile(){},onDrop:function onDrop(){},onDropAccepted:function onDropAccepted(){},onDropRejected:function onDropRejected(){},onUrlSubmit:function onUrlSubmit(){},onUrlInputChange:function onUrlInputChange(){},onClosePreview:function onClosePreview(){}};module.exports=exports['default'];
//# sourceMappingURL=index.js.map
